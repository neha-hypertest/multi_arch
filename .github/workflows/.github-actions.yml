name: GitHub Actions
run-name: ${{ github.actor }} is testing out GitHub Actions ğŸš€
on: [push]
jobs:
  armv7_job:
    # The host should always be Linux
    runs-on: ubuntu-22.04
    name: Build on ubuntu-18.04 armv7
    steps:
      - uses: actions/checkout@v2.1.0
      - uses: uraimo/run-on-arch-action@v2
        name: Run commands
        id: runcmd
        with:
          arch: aarch64	
          distro: ubuntu22.04
          run: |
            echo "starting commands"
            uname -a
            echo "Runner architecture"
            dpkg --print-architecture
            # echo ::set-output name=uname::$(uname -a)
            echo "updating "
            apt-get update > /dev/null
            echo "installing curl"
            apt install -y curl > /dev/null
            echo "installing docker"
            curl -fsSL https://get.docker.com -o get-docker.sh && sh get-docker.sh > /dev/null   
            docker -v 
            # docker run hello-world
            ls
            echo "installing npm"
            apt-get install npm --no-install-recommends
            echo "installing yarn"
            npm install -y -g yarn
            dpkg --print-architecture
            pwd 
            ls
            yarn install
            export PACKAGE_VERSION=$(node -p "require('./package.json').version")
            npm install -y -g pkg            
            pkg index.js --compress Gzip --targets node16-linux-amd64 --out-path bin 
            ls bin/

#       - run: echo "ğŸ‰ The job was automatically triggered by a ${{ github.event_name }} event."
#       - run: echo "ğŸ§ This job is now running on a ${{ runner.os }} server hosted by GitHub!"
#       - run: echo "ğŸ” The name of your branch is ${{ github.ref }} and your repository is ${{ github.repository }}."
#         - name: Check out repository code
#           uses: actions/checkout@v3
#         - uses: pguyot/arm-runner-action@v2
#           with:
#             base_image: raspios_lite:2022-04-04
#             commands: |
#               dpkg --print-architecture
#               ls
# #       - run: echo "ğŸ’¡ The ${{ github.repository }} repository has been cloned to the runner."
# #       - run: echo "ğŸ–¥ï¸ The workflow is now ready to test your code on the runner."
# #       - name: List files in the repository
# #         run: |
# #           ls ${{ github.workspace }}
# #       - run: echo "ğŸ This job's status is ${{ job.status }}."
# #         - run: sudo apt install npm
# #         - run: sudo npm install -y -g yarn
# #         - run: yarn install
# #         - run: export PACKAGE_VERSION=$(node -p "require('./package.json').version")
# #         - run: npm install -g pkg
       
#         - run: pkg index.js --compress Gzip --targets node16-linux-arm64 --out-path bin 
